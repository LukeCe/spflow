<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>A function to compute the Jacobean term in the spatial econometric interaction model — derive_logdet_calculator • spflow</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="A function to compute the Jacobean term in the spatial econometric interaction model — derive_logdet_calculator"><meta property="og:description" content="These are internal functions called within the estimation procedure"><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spflow</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/paris_commute_flows.html">Home-to-work commuting flows within the municipalities around Paris</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/LukeCe/spflow/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A function to compute the Jacobean term in the spatial econometric interaction model</h1>
    <small class="dont-index">Source: <a href="https://github.com/LukeCe/spflow/blob/HEAD/R/spflow_logdet.R" class="external-link"><code>R/spflow_logdet.R</code></a></small>
    <div class="hidden name"><code>derive_logdet_calculator.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These are internal functions called within the estimation procedure</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_logdet_calculator</span><span class="op">(</span></span>
<span>  <span class="va">OW</span>,</span>
<span>  <span class="va">DW</span>,</span>
<span>  <span class="va">n_o</span>,</span>
<span>  <span class="va">n_d</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">approx_order</span>,</span>
<span>  <span class="va">is_cartesian</span>,</span>
<span>  <span class="va">M_indicator</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">derive_approxldet_cartesian</span><span class="op">(</span><span class="va">OW</span>, <span class="va">DW</span>, <span class="va">n_o</span>, <span class="va">n_d</span>, <span class="va">model</span>, <span class="va">approx_order</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">derive_approxldet_cartesian2</span><span class="op">(</span><span class="va">OW</span>, <span class="va">DW</span>, <span class="va">n_o</span>, <span class="va">n_d</span>, <span class="va">model</span><span class="op">)</span> <span class="co"># order = 2</span></span>
<span></span>
<span><span class="fu">derive_approxldet_noncartesian</span><span class="op">(</span><span class="va">Wd</span>, <span class="va">Wo</span>, <span class="va">Ww</span>, <span class="va">approx_order</span>, <span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">derive_approxldet_noncartesian2</span><span class="op">(</span><span class="va">OW</span>, <span class="va">DW</span>, <span class="va">M_indicator</span>, <span class="va">n_o</span>, <span class="va">n_d</span>, <span class="va">model</span><span class="op">)</span> <span class="co"># order = 2</span></span>
<span></span>
<span><span class="fu">tracevals2params_cartesian</span><span class="op">(</span><span class="va">OW</span>, <span class="va">DW</span>, <span class="va">n_o</span>, <span class="va">n_d</span>, <span class="va">model</span>, <span class="va">approx_order</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tracevals2params_noncartesian</span><span class="op">(</span><span class="va">Wd</span>, <span class="va">Wo</span>, <span class="va">Ww</span>, <span class="va">model</span>, <span class="va">approx_order</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trace_template_noncartesian</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tracevals2approxldet</span><span class="op">(</span><span class="va">tracevals</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="value">
    <h2>Value</h2>
    

<p>A function that takes the autoregression parameters as an argument and returns the log-determinant value</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The Jacobean term of the model corresponds to the log-determinant of the
spatial filter matrix, which is costly to compute.
To reduce the computational burden of the MLE or MCMC estimators the package
uses a power-series approximation of this term.
This approximation was first proposed by Martin (1992)
,
has been adapted to interaction models by LeSage and Pace (2008)
 and
Dargel and Thomas-Agnan (2023)
 extend the approximation to the
non-cartesian and rectangular cases, where the OD-matrix can be sparse and where the
list of origins may be different from the list of destinations.</p>
<p>By using this approximation we can avoid to directly calculate the determinant term.
Moreover, it is possible to factor out the autoregression parameters from
all remaining terms, which means that we do not need to repeat the most
costly computations.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Dargel L, Thomas-Agnan C (2023).
“Efficient Estimation of Spatial Econometric Interaction Models for Sparse OD Matrices.”
TSE Working Paper, n. 23-1409, February 2023, <a href="https://www.tse-fr.eu/publications/generalized-framework-estimating-spatial-econometric-interaction-models" class="external-link">https://www.tse-fr.eu/publications/generalized-framework-estimating-spatial-econometric-interaction-models</a>.<br><br> LeSage JP, Pace RK (2008).
“Spatial Econometric Modeling of Origin-Destination Flows.”
<em>Journal of Regional Science</em>, 941--967.
<a href="https://doi.org/10.1111/j.1467-9787.2008.00573.x" class="external-link">https://doi.org/10.1111/j.1467-9787.2008.00573.x</a>.<br><br> Martin RJ (1992).
“Approximations to the determinant term in gaussian maximum likelihood estimation of some spatial models.”
<em>Communications in Statistics - Theory and Methods</em>, 189--205.
<a href="https://doi.org/10.1080/03610929308831013" class="external-link">https://doi.org/10.1080/03610929308831013</a>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lukas Dargel</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lukas Dargel, Thibault Laurent.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

