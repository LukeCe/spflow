<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate spatial interaction models that incorporate spatial dependence — spflow • spflow</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate spatial interaction models that incorporate spatial dependence — spflow"><meta property="og:description" content="We implement three different estimators of spatial econometric interaction
models (Dargel 2021)
 that allow the user to estimate
origin-destination flows with spatial autocorrelation.
By default the estimation will include spatial dependence in the dependent
variable and the explanatory variables, which leads to the spatial Durbin
model (SDM) (Anselin 1988)
.
Moreover, the model includes an additional set of parameters for intra
regional flows that start and end in the same geographic site (as proposed
by LeSage and Pace (2009)
).
Both default options can be deactivated via the estimation_control argument,
which gives fine grained control over the estimation."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spflow</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/paris_commute_flows.html">Home-to-work commuting flows within the municipalities around Paris</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/LukeCe/spflow/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate spatial interaction models that incorporate spatial dependence</h1>
    <small class="dont-index">Source: <a href="https://github.com/LukeCe/spflow/blob/HEAD/R/spflow.R" class="external-link"><code>R/spflow.R</code></a></small>
    <div class="hidden name"><code>spflow.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>We implement three different estimators of spatial econometric interaction
models (Dargel 2021)
 that allow the user to estimate
origin-destination flows with spatial autocorrelation.</p>
<p>By default the estimation will include spatial dependence in the dependent
variable and the explanatory variables, which leads to the spatial Durbin
model (SDM) (Anselin 1988)
.
Moreover, the model includes an additional set of parameters for intra
regional flows that start and end in the same geographic site (as proposed
by LeSage and Pace (2009)
).
Both default options can be deactivated via the <code>estimation_control</code> argument,
which gives fine grained control over the estimation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spflow</span><span class="op">(</span></span>
<span>  <span class="va">spflow_formula</span>,</span>
<span>  <span class="va">spflow_networks</span>,</span>
<span>  id_net_pair <span class="op">=</span> <span class="fu"><a href="spflow_generics.html">id</a></span><span class="op">(</span><span class="va">spflow_networks</span><span class="op">)</span><span class="op">[[</span><span class="st">"pairs"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  estimation_control <span class="op">=</span> <span class="fu"><a href="spflow_control.html">spflow_control</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>spflow_formula</dt>
<dd><p>A formula specifying the spatial interaction model (for details see
section Formula interface)</p></dd>


<dt>spflow_networks</dt>
<dd><p>A <code><a href="spflow_network_multi.html">spflow_network_multi()</a></code> object that contains information on the
origins, the destinations and their neighborhood structure</p></dd>


<dt>id_net_pair</dt>
<dd><p>A character indicating the id of a <code><a href="spflow_network_pair.html">spflow_network_pair()</a></code> (only relevant if
the <code><a href="spflow_network_multi.html">spflow_network_multi()</a></code> contains multiple <code>spflow_network_pair</code>-objects:
defaults to the of them)</p></dd>


<dt>estimation_control</dt>
<dd><p>A list generated by <code><a href="spflow_control.html">spflow_control()</a></code> that provides fine grained control
over the estimation procedure</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An S4 class of type <code><a href="spflow_model-class.html">spflow_model-class()</a></code></p>


    </div>
    <div id="details">
    <h2>Details</h2>
    

<p>Our estimation procedures makes use of the matrix formulation introduced by
LeSage and Pace (2008)
 and further developed by
Dargel (2021)
 to reduce the computational
effort and memory requirements.
Further generalizations to deal with non-cartesian and rectangular flows
are developed by Dargel and Thomas-Agnan (2023)
.</p>
<p>The estimation procedure can be adjusted through the <code>estimation_method</code>
argument in <code><a href="spflow_control.html">spflow_control()</a></code>.</p><div class="section">
<h3 id="maximum-likelihood-estimation-mle-">Maximum likelihood estimation (MLE)<a class="anchor" aria-label="anchor" href="#maximum-likelihood-estimation-mle-"></a></h3>


<p>Maximum likelihood estimation is the default estimation procedure.
The matrix form estimation in the framework of this model was first
developed by LeSage and Pace (2008)
 and then improved by
Dargel (2021)
.</p>
</div>

<div class="section">
<h3 id="spatial-two-stage-least-squares-s-sls-">Spatial two-stage least squares (S2SLS)<a class="anchor" aria-label="anchor" href="#spatial-two-stage-least-squares-s-sls-"></a></h3>


<p>The S2SLS estimator is an adaptation of the one proposed by
Kelejian and Prucha (1998)
, to the case of origin-destination
flows, with up to three neighborhood matrices
Dargel (2021)
.
A similar estimation is done by Tamesue and Tsutsumi (2016)
.
The user can activate the S2SLS estimation via the <code>estimation_control</code> argument
using the input <code>spflow_control(estimation_method = "s2sls")</code>.</p>
</div>

<div class="section">
<h3 id="bayesian-markov-chain-monte-carlo-mcmc-">Bayesian Markov Chain Monte Carlo (MCMC)<a class="anchor" aria-label="anchor" href="#bayesian-markov-chain-monte-carlo-mcmc-"></a></h3>


<p>The MCMC estimator is based on the ideas of
LeSage and Pace (2009)
 and incorporates the improvements
proposed in Dargel (2021)
.
The estimation is based on a tuned Metropolis-Hastings sampler for the
auto-regressive parameters, and for the remaining parameters it uses Gibbs
sampling.
The routine uses 5500 iterations of the sampling procedure and considers the
first 2500 as burn-in period.
The user can activate the S2SLS estimation via the <code>estimation_control</code> argument
using the input <code>spflow_control(estimation_method = "mcmc")</code>.</p>
</div>

<div class="section">
<h3 id="formula-interface">Formula interface<a class="anchor" aria-label="anchor" href="#formula-interface"></a></h3>


<p>The function offers a formula interface adapted to spatial interaction
models, which has the following structure:
<code>Y ~ O_(X1) + D_(X2) + I_(X3) + P_(X4)</code>
This structure reflects the different data sources involved in such a model.
On the left hand side there is the independent variable <code>Y</code> which
corresponds to the vector of flows.
On the right hand side we have all the explanatory variables.
The functions <code>O_(...)</code> and <code>D_(...)</code> indicate which variables are used as
characteristics of the origins and destinations respectively.
Similarly, <code>I_(...)</code> indicates variables that should be used for the
intra-regional parameters.
Finally, <code>P_(...)</code> declares which variables describe origin-destination
pairs, which most frequently will include a measure of distance.</p>
<p>All the declared variables must be available in the provided
<code><a href="spflow_network_multi.html">spflow_network_multi()</a></code> object, which gathers information on the origins and
destinations (inside <code><a href="spflow_network.html">spflow_network()</a></code> objects), as well as the
information on the origin-destination pairs (inside a <code><a href="spflow_network_pair.html">spflow_network_pair()</a></code>
object).</p>
<p>Using the short notation <code>Y ~ .</code> is possible and will be interpreted as
usual, in the sense that we use all variables that are available for each
data source.
Also mixed formulas, such as <code>Y ~ . + P_(log(X4) + 1)</code>, are possible.
When the dot shortcut is combined with explicit declaration, it will only be
used for the non declared data sources.
The following examples illustrate this behavior.</p>
</div>

<div class="section">
<h3 id="formula-interface-examples-">Formula interface (examples)<a class="anchor" aria-label="anchor" href="#formula-interface-examples-"></a></h3>


<p>Consider the case where we have the flow vector <code>Y</code> and the distance vector
<code>DIST</code> available as information on origin-destination pairs.
In addition we have  the explanatory variables <code>X1, X2</code> and <code>X3</code> which
describe the regions that are at the same time origins and destinations of
the flows.</p>
<p>For this example the four formulas below are equivalent and make use of all
explanatory variables <code>X1, X2</code> and <code>X3</code> for origins, destinations and
intra-regional observations.</p><ul><li><p><code>Y ~ .</code></p></li>
<li><p><code>Y ~ . + P_(DIST)</code></p></li>
<li><p><code>Y ~ X1 + X2 + X3 + P_(DIST)</code></p></li>
<li><p><code>Y ~ D_(X1 + X2 + X3) + O_(X1 + X2 + X3) + I_(X1 + X2 + X3)  + P_(DIST)</code></p></li>
</ul><p>Now if we only want to use X1 for the intra-regional model we can do the
following (again all four options below are equivalent).</p><ul><li><p><code>Y ~ . + I_(X1)</code></p></li>
<li><p><code>Y ~ . + I_(X1) + P_(DIST)</code></p></li>
<li><p><code>Y ~  X1 + X2 + X3 + I_(X1) + P_(DIST)</code></p></li>
<li><p><code>Y ~ D_(X1 + X2 + X3) + O_(X1 + X2 + X3) + I_(X1)  + P_(DIST)</code></p></li>
</ul><p>This behavior is easily combined with transformation of variables as the
two equivalent options below illustrate.</p><ul><li><p><code>log(Y + 1) ~ sqrt(X1) +  X2 + P_(log(DIST + 1))</code></p></li>
</ul></div>

    </div>
    <div id="references">
    <h2>References</h2>
    <p>Anselin L (1988).
<em>Spatial Econometrics: Methods and Models</em>.
Springer Netherlands.
<a href="2020-03-24">2020-03-24</a>.<br><br> Dargel L (2021).
“Revisiting estimation methods for spatial econometric interaction models.”
<em>Journal of Spatial Econometrics</em>, 10.
<a href="https://doi.org/10.1007/s43071-021-00016-1" class="external-link">https://doi.org/10.1007/s43071-021-00016-1</a>.<br><br> Dargel L, Thomas-Agnan C (2023).
“Efficient Estimation of Spatial Econometric Interaction Models for Sparse OD Matrices.”
TSE Working Paper, n. 23-1409, February 2023, <a href="https://www.tse-fr.eu/publications/generalized-framework-estimating-spatial-econometric-interaction-models" class="external-link">https://www.tse-fr.eu/publications/generalized-framework-estimating-spatial-econometric-interaction-models</a>.<br><br> Kelejian HH, Prucha IR (1998).
“A Generalized Spatial Two-Stage Least Squares Procedure for Estimating a Spatial Autoregressive Model with Autoregressive Disturbances.”
<em>The Journal of Real Estate Finance and Economics</em>, 99--121.
<a href="https://doi.org/10.1023/A:1007707430416" class="external-link">https://doi.org/10.1023/A:1007707430416</a>.<br><br> LeSage JP, Pace RK (2008).
“Spatial Econometric Modeling of Origin-Destination Flows.”
<em>Journal of Regional Science</em>, 941--967.
<a href="https://doi.org/10.1111/j.1467-9787.2008.00573.x" class="external-link">https://doi.org/10.1111/j.1467-9787.2008.00573.x</a>.<br><br> LeSage JP, Pace RK (2009).
<em>Introduction to Spatial Econometrics</em>.
CRC Press.<br><br> Tamesue K, Tsutsumi M (2016).
“Dealing with Intraregional Flows in Spatial Econometric Gravity Models.”
In Patuelli R, Arbia G (eds.), <em>Spatial Econometric Interaction Modelling</em>, chapter 6, 105--119.
Springer International Publishing.
<a href="https://doi.org/10.1007/978-3-319-30196-9_6" class="external-link">https://doi.org/10.1007/978-3-319-30196-9_6</a>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="spflow_control.html">spflow_control()</a></code> <code><a href="spflow_network_classes.html">spflow_network_classes()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lukas Dargel</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate flows between the states of Germany</span></span></span>
<span class="r-in"><span><span class="fu">spflow</span><span class="op">(</span>spflow_formula <span class="op">=</span> <span class="va">y9</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="fu">P_</span><span class="op">(</span><span class="va">DISTANCE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       spflow_networks <span class="op">=</span> <span class="va">multi_net_usa_ge</span>,</span></span>
<span class="r-in"><span>       id_net_pair <span class="op">=</span> <span class="st">"ge_ge"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial interaction model estimated by: MLE  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial correlation structure: SDM (model_9)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependent variable: y9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 est     sd   t.stat  p.val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_d         0.497  0.030   16.499      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_o         0.333  0.037    9.001      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_w        -0.227  0.044   -5.117      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  10.198  2.161    4.719      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intra)       9.871  1.531    6.445      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_X           0.983  0.069   14.321      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_X.lag1      0.509  0.115    4.437      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O_X          -0.759  0.038  -19.917      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O_X.lag1     -0.367  0.093   -3.965      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I_X           2.035  0.083   24.650      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P_DISTANCE   -2.622  0.384   -6.829      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2_corr: 0.9921423  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observations: 256  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model coherence: Validated</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above with explicit declaration of variables...</span></span></span>
<span class="r-in"><span><span class="co"># ... X is the only variable available</span></span></span>
<span class="r-in"><span><span class="co"># ... it is used for origins, destination and intra-state flows</span></span></span>
<span class="r-in"><span><span class="fu">spflow</span><span class="op">(</span>spflow_formula <span class="op">=</span> <span class="va">y9</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu">P_</span><span class="op">(</span><span class="va">DISTANCE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       spflow_networks <span class="op">=</span> <span class="va">multi_net_usa_ge</span>,</span></span>
<span class="r-in"><span>       id_net_pair <span class="op">=</span> <span class="st">"ge_ge"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial interaction model estimated by: MLE  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial correlation structure: SDM (model_9)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependent variable: y9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 est     sd   t.stat  p.val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_d         0.497  0.030   16.499      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_o         0.333  0.037    9.001      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_w        -0.227  0.044   -5.117      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  10.198  2.161    4.719      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intra)       9.871  1.531    6.445      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_X           0.983  0.069   14.321      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_X.lag1      0.509  0.115    4.437      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O_X          -0.759  0.038  -19.917      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O_X.lag1     -0.367  0.093   -3.965      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I_X           2.035  0.083   24.650      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P_DISTANCE   -2.622  0.384   -6.829      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2_corr: 0.9921423  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observations: 256  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model coherence: Validated</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above</span></span></span>
<span class="r-in"><span><span class="fu">spflow</span><span class="op">(</span>spflow_formula <span class="op">=</span> <span class="va">y9</span> <span class="op">~</span> <span class="fu">O_</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu">D_</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu">I_</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">+</span> <span class="fu">P_</span><span class="op">(</span><span class="va">DISTANCE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       spflow_networks <span class="op">=</span> <span class="va">multi_net_usa_ge</span>,</span></span>
<span class="r-in"><span>       id_net_pair <span class="op">=</span> <span class="st">"ge_ge"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial interaction model estimated by: MLE  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial correlation structure: SDM (model_9)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependent variable: y9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 est     sd   t.stat  p.val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_d         0.497  0.030   16.499      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_o         0.333  0.037    9.001      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_w        -0.227  0.044   -5.117      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  10.198  2.161    4.719      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intra)       9.871  1.531    6.445      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_X           0.983  0.069   14.321      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_X.lag1      0.509  0.115    4.437      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O_X          -0.759  0.038  -19.917      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O_X.lag1     -0.367  0.093   -3.965      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I_X           2.035  0.083   24.650      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P_DISTANCE   -2.622  0.384   -6.829      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2_corr: 0.9921423  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observations: 256  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model coherence: Validated</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above</span></span></span>
<span class="r-in"><span><span class="fu">spflow</span><span class="op">(</span>spflow_formula <span class="op">=</span> <span class="va">y9</span> <span class="op">~</span> <span class="fu">O_</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fu">D_</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fu">I_</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fu">P_</span><span class="op">(</span><span class="va">DISTANCE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       spflow_networks <span class="op">=</span> <span class="va">multi_net_usa_ge</span>,</span></span>
<span class="r-in"><span>       id_net_pair <span class="op">=</span> <span class="st">"ge_ge"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial interaction model estimated by: MLE  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial correlation structure: SDM (model_9)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependent variable: y9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 est     sd   t.stat  p.val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_d         0.497  0.030   16.499      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_o         0.333  0.037    9.001      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho_w        -0.227  0.044   -5.117      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  10.198  2.161    4.719      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intra)       9.871  1.531    6.445      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_X           0.983  0.069   14.321      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_X.lag1      0.509  0.115    4.437      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O_X          -0.759  0.038  -19.917      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O_X.lag1     -0.367  0.093   -3.965      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I_X           2.035  0.083   24.650      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P_DISTANCE   -2.622  0.384   -6.829      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2_corr: 0.9921423  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observations: 256  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model coherence: Validated</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lukas Dargel, Thibault Laurent.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

